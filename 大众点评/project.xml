<root>
  <Doc Name="" Description="" Version="0" SavePath="D:\TopCoder\Hawk-Projects\大众点评\project.xml">
    <DBConnections>
      <Children DBName="datamining" Name="MongoDB" TypeName="MongoDBConnector" ConnectString="mongodb://127.0.0.1" AutoConnect="True" />
      <Children DBName="" Name="文件管理" TypeName="FileManager" ConnectString="" AutoConnect="True" />
    </DBConnections>
    <Children Name="门店列表" Type="SmartCrawler" URL="http://www.dianping.com/search/category/2/10/g311r14p2" RootXPath="" IsMultiData="List" URLFilter="" ContentFilter="" CreateTime="2016/5/1 16:31:32" Description="任务描述" ScriptPath="">
      <HttpSet URL="http://www.dianping.com/search/category/2/10/g311r14p2" Allowautoredirect="False" Postdata="" Encoding="Unknown" Method="GET" Parameters="Host: www.dianping.com&#xA;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36&#xA;Cookie:s_ViewType=10;Domain=.dianping.com;Expires=Thu;05-Jun-2018 09:10:02 GMT=;Path=/;JSESSIONID=7B790EF85A4BA7A52302D1D54730FF18;aburl=1;05-Jun-2017 09:10:03 GMT=;cy=2;cye=beijing;05-Jun-2018 09:10:00 GMT=;05-Jun-2017 09:10:01 GMT=;05-Jun-2018 09:09:32 GMT=;05-Jun-2017 09:09:33 GMT=;05-Jun-2018 09:09:20 GMT=;05-Jun-2017 09:09:21 GMT=;03-Jun-2018 03:56:44 GMT=;03-Jun-2017 03:56:45 GMT=;03-Jun-2018 03:56:43 GMT=;03-Jun-2017 03:56:44 GMT=;03-Jun-2018 03:45:31 GMT=;03-Jun-2017 03:45:31 GMT=;03-Jun-2018 03:45:30 GMT=;03-Jun-2018 03:26:44 GMT=;03-Jun-2017 03:26:45 GMT=;01-Jun-2018 07:37:25 GMT=;01-Jun-2017 07:37:25 GMT=;01-Jun-2018 07:37:23 GMT=;01-Jun-2017 07:37:24 GMT=;01-Jun-2018 07:26:52 GMT=;01-Jun-2017 07:26:53 GMT=;15-Apr-2018 06:20:29 GMT=;15-Apr-2017 06:20:29 GMT=;28-Mar-2018 14:41:45 GMT=;28-Mar-2017 14:41:45 GMT=;24-Mar-2018 14:25:41 GMT=;24-Mar-2017 14:25:42 GMT=;24-Mar-2018 03:26:35 GMT=;24-Mar-2017 03:26:36 GMT=;24-Mar-2018 02:53:54 GMT=;24-Mar-2017 02:53:54 GMT=;24-Mar-2018 02:03:39 GMT=;24-Mar-2017 02:03:40 GMT=;23-Mar-2018 10:27:54 GMT=;23-Mar-2017 10:27:55 GMT=;23-Mar-2018 10:21:04 GMT=;23-Mar-2017 10:21:04 GMT=;23-Mar-2018 09:48:03 GMT=;23-Mar-2017 09:48:03 GMT=;23-Mar-2018 02:54:33 GMT=;23-Mar-2017 02:54:34 GMT=;23-Mar-2018 02:38:15 GMT=;23-Mar-2017 02:38:16 GMT=;23-Mar-2018 01:52:15 GMT=;23-Mar-2017 01:52:16 GMT=;23-Mar-2018 01:52:14 GMT=;23-Mar-2017 01:52:15 GMT=;23-Mar-2017 01:12:58 GMT=;23-Mar-2017 01:12:56 GMT=;23-Mar-2017 01:12:54 GMT=;_hc.v=&quot;\&quot;7ebbc90d-1288-4f90-bf2f-e6bcd3e653c1.1446514502\&quot;&quot;;__utma=1.1290031819.1455245681.1455245681.1455245681.1;__utmz=1.1455245681.1.1.utmcsr=dianping.com|utmccn=(referral)|utmcmd=referral|utmcct=/search/category/2/20/g119r15p2;PHOENIX_ID=0a650671-153a106beb0-984c419&#xA;Connection: keep-alive&#xA;Cache-Control: max-age=0&#xA;Upgrade-Insecure-Requests: 1&#xA;Accept-Encoding: gzip, deflate, sdch&#xA;Accept-Language: zh-CN,zh;q=0.8&#xA;" />
      <Children Name="标题" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[1]/a[1]/img[1]/@title[1]" IsHtml="False" />
      <Children Name="ID" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[1]/a[1]/@href[1]" IsHtml="False" />
      <Children Name="介绍" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[2]/div[1]/div[1]/a[1]/@title[1]" IsHtml="False" />
      <Children Name="星级" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[2]/div[2]/span[1]/@title[1]" IsHtml="False" />
      <Children Name="点评" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/div[2]/a[1]/b[1]" IsHtml="False" />
      <Children Name="均价" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/div[2]/a[2]/b[1]" IsHtml="False" />
      <Children Name="类型" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/div[3]/a[1]/span[1]" IsHtml="False" />
      <Children Name="区域" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/div[3]/a[2]/span[1]" IsHtml="False" />
      <Children Name="地址" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/div[3]/span[1]" IsHtml="False" />
      <Children Name="口味" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[2]/span[1]/span[1]/b[1]" IsHtml="False" />
      <Children Name="环境" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[2]/div[2]/span[1]/span[2]/b[1]" IsHtml="False" />
      <Children Name="服务" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[2]/span[1]/span[3]/b[1]" IsHtml="False" />
      <Children Name="其他" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[3]/a[1]/@title[1]" IsHtml="False" />
      <Children Name="总店" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[4]/a[3]/@data-sname[1]" IsHtml="False" />
      <Children Name="总店id" XPath="/html[1]/body[1]/div[6]/div[3]/div[1]/div[1]/div[2]/ul[1]/li[1]/div[4]/a[3]/@data-shopid[1]" IsHtml="False" />
    </Children>
    <Children Name="获取所有门店" Type="SmartETLTool" MaxThreadCount="20" GenerateMode="并行模式" SampleMount="20" CreateTime="2016/5/1 16:31:32" Description="主流程" ScriptPath="大众点评.py">
      <Children Position="0" MergeType="Append" ETLSelector="类别" Column="" Enabled="True" Type="EtlGE" Group="Generator" />
      <Children Column="HTML" NewColumn="type" Enabled="True" OneOutput="False" IsMultiYield="False" Type="RenameTF" Group="Transformer" />
      <Children Column="Text" NewColumn="门类" Enabled="True" OneOutput="False" IsMultiYield="False" Type="RenameTF" Group="Transformer" />
      <Children Position="0" MergeType="Cross" ETLSelector="区域" Column="type" Enabled="True" Type="EtlGE" Group="Generator" />
      <Children Column="OHTML" NewColumn="region" Enabled="True" OneOutput="False" IsMultiYield="False" Type="RenameTF" Group="Transformer" />
      <Children MergeWith="region city" Format="http://www.dianping.com/search/category/{2}/10/{0}{1}" Column="type" NewColumn="url" Enabled="True" OneOutput="True" IsMultiYield="False" Type="MergeTF" Group="Transformer" />
      <Children MaxTryCount="1" CrawlerSelector="网页采集器-通用" IsRegex="False" Column="url" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="CrawlerTF" Group="Transformer" />
      <Children XPath="/html[1]/body[1]/div[6]/div[1]/span[7]" IsManyData="False" GetText="False" GetCount="False" IsInsertNull="False" Column="Content" NewColumn="page" Enabled="True" OneOutput="True" IsMultiYield="False" Type="XPathTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="0" Script="(-?\d+)(\.\d+)?" NewColumn="" Column="page" Enabled="True" OneOutput="True" Type="NumberTF" Group="Transformer" />
      <Children IDColumn="[门类]" MountColumn="[page]" DisplayProgress="True" Column="page" NewColumn="" Enabled="True" OneOutput="True" IsMultiYield="True" Type="ToListTF" Group="Transformer" />
      <Children Column="Content" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="DeleteTF" Group="Transformer" />
      <Children ScriptWorkMode="不进行转换" Script="50 if int(value) &gt;750 else int(int(value)/15.0+1)" Column="page" NewColumn="page" Enabled="True" OneOutput="False" IsMultiYield="False" Type="PythonTF" Group="Transformer" />
      <Children MinValue="1" MaxValue="[page]" Interval="1" Column="np" Enabled="True" Position="0" MergeType="Cross" Type="RangeGE" Group="Generator" />
      <Children MergeWith="region np city" Format="http://www.dianping.com/search/category/{3}/10/{0}{1}p{2}" Column="type" NewColumn="url" Enabled="True" OneOutput="True" IsMultiYield="False" Type="MergeTF" Group="Transformer" />
      <Children MaxTryCount="1" CrawlerSelector="门店列表" IsRegex="False" Column="url" NewColumn="Text city 大类" Enabled="True" OneOutput="False" IsMultiYield="True" Type="CrawlerTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="0" Script="(-?\d+)(\.\d+)?" NewColumn="" Column="均价" Enabled="True" OneOutput="True" Type="NumberTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="0" Script="(-?\d+)(\.\d+)?" NewColumn="Text" Column="Text" Enabled="True" OneOutput="True" Type="NumberTF" Group="Transformer" />
      <Children Column="Text" NewColumn="区县" Enabled="True" OneOutput="False" IsMultiYield="False" Type="RenameTF" Group="Transformer" />
      <Children ExecuteType="OnlyInsert" TableName="dianpingsh" Column="ID" Enabled="True" Type="DbEX" Group="Executor" Connector="MongoDB" />
    </Children>
    <Children Name="类别" Type="SmartETLTool" MaxThreadCount="20" GenerateMode="串行模式" SampleMount="20" CreateTime="2016/5/1 16:31:32" Description="获取一个城市的所有类别" ScriptPath="">
      <Children Content="1" Column="city" Name="城市" Enabled="True" Position="0" MergeType="Append" Type="TextGE" Group="Generator" />
      <Children MergeWith="" Format="https://www.dianping.com/shopall/{0}/0" Column="city" NewColumn="url" Enabled="True" OneOutput="True" IsMultiYield="False" Type="MergeTF" Group="Transformer" />
      <Children MaxTryCount="1" CrawlerSelector="网页采集器-通用" IsRegex="False" Column="url" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="CrawlerTF" Group="Transformer" />
      <Children XPath="/html[1]/body[1]/div[6]/div[1]/div[1]/dl[1]/dd[1]/ul[1]/li" IsManyData="True" GetText="False" GetCount="False" IsInsertNull="False" Column="Content" Name="xpath筛选" NewColumn="" Enabled="True" OneOutput="True" IsMultiYield="True" Type="XPathTF" Group="Transformer" />
      <Children ConvertType="Decode" Column="Text" NewColumn="" Enabled="True" OneOutput="True" IsMultiYield="False" Type="HtmlTF" Group="Transformer" />
      <Children FromBack="False" ShouldSplitChars="False" SplitPause="True" SplitNull="True" Index="0" SplitChar="" Column="Text" NewColumn="Text" Enabled="True" OneOutput="True" IsMultiYield="False" Type="SplitTF" Group="Transformer" />
      <Children Column="OHTML" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="DeleteTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="1" Script="(-?\d+)(\.\d+)?" NewColumn="大类" Column="HTML" Enabled="True" OneOutput="True" Type="NumberTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="0" Script="g\d+" NewColumn="" Column="HTML" Enabled="True" OneOutput="True" Type="RegexTF" Group="Transformer" />
    </Children>
    <Children Name="网页采集器-通用" Type="SmartCrawler" URL="http://www.dianping.com/shopall/2/0" RootXPath="" IsMultiData="One" URLFilter="https://www.dianping.com/shopall/2/0" ContentFilter="" CreateTime="2016/5/1 16:31:32" Description="任务描述" ScriptPath="">
      <HttpSet URL="http://bj.lianjia.com/xiaoqu/dongcheng/" Allowautoredirect="True" Postdata="" Encoding="Unknown" Method="GET" Parameters="Host: www.dianping.com&#xA;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36&#xA;Cookie:s_ViewType=10;Domain=.dianping.com;Expires=Sat;05-Jun-2018 09:09:59 GMT=;Path=/;JSESSIONID=6BF07C4F9586310660746498AB7EE232;aburl=1;05-Jun-2017 09:10:00 GMT=;cy=1;cye=shanghai;05-Jun-2017 09:09:59 GMT=;05-Jun-2018 09:09:58 GMT=;05-Jun-2017 09:09:58 GMT=;03-Jun-2018 03:56:42 GMT=;03-Jun-2017 03:56:43 GMT=;03-Jun-2017 03:56:42 GMT=;03-Jun-2018 03:56:41 GMT=;03-Jun-2017 03:56:41 GMT=;03-Jun-2018 03:45:29 GMT=;03-Jun-2017 03:45:30 GMT=;03-Jun-2018 03:45:28 GMT=;03-Jun-2017 03:45:29 GMT=;03-Jun-2018 03:45:27 GMT=;03-Jun-2017 03:45:28 GMT=;03-Jun-2017 03:45:27 GMT=;03-Jun-2018 03:36:15 GMT=;03-Jun-2017 03:36:15 GMT=;03-Jun-2018 03:36:14 GMT=;03-Jun-2018 03:36:13 GMT=;03-Jun-2017 03:36:14 GMT=;03-Jun-2018 03:36:12 GMT=;03-Jun-2017 03:36:13 GMT=;03-Jun-2017 03:36:12 GMT=;03-Jun-2018 03:36:11 GMT=;03-Jun-2017 03:36:11 GMT=;03-Jun-2018 03:36:10 GMT=;03-Jun-2017 03:36:10 GMT=;03-Jun-2018 03:36:09 GMT=;03-Jun-2018 03:36:08 GMT=;03-Jun-2017 03:36:09 GMT=;03-Jun-2018 03:36:07 GMT=;03-Jun-2017 03:36:08 GMT=;03-Jun-2018 03:35:45 GMT=;03-Jun-2017 03:35:46 GMT=;03-Jun-2017 03:35:35 GMT=;03-Jun-2017 03:34:43 GMT=;PHOENIX_ID=0a650671-155143e7ed4-3739e2c;_hc.v=&quot;\&quot;2eae5dac-504c-4a1d-a9a2-dd06ba2e29a5.1464923489\&quot;&quot;&#xA;Connection: keep-alive&#xA;Cache-Control: max-age=0&#xA;Upgrade-Insecure-Requests: 1&#xA;Accept-Encoding: gzip, deflate, sdch&#xA;Accept-Language: zh-CN,zh;q=0.8&#xA;" />
    </Children>
    <Children Name="区域" Type="SmartETLTool" MaxThreadCount="20" GenerateMode="串行模式" SampleMount="20" CreateTime="2016/5/1 16:31:32" Description="获取一个城市中所有的区县" ScriptPath="">
      <Children Content="1" Column="city" Name="城市" Enabled="True" Position="0" MergeType="Append" Type="TextGE" Group="Generator" />
      <Children MergeWith="" Format="http://www.dianping.com/search/category/{0}/0/" Column="city" NewColumn="url" Enabled="True" OneOutput="True" IsMultiYield="False" Type="MergeTF" Group="Transformer" />
      <Children MaxTryCount="1" CrawlerSelector="网页采集器-通用" IsRegex="False" Column="url" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="CrawlerTF" Group="Transformer" />
      <Children XPath="//*[@id=&quot;region-nav&quot;]/a" IsManyData="True" GetText="False" GetCount="False" IsInsertNull="False" Column="Content" NewColumn="city" Enabled="True" OneOutput="True" IsMultiYield="True" Type="XPathTF" Group="Transformer" />
      <Children Column="HTML" NewColumn="" Enabled="True" OneOutput="False" IsMultiYield="False" Type="DeleteTF" Group="Transformer" />
      <Children IsMultiYield="False" Index="0" Script="r\d+" NewColumn="" Column="OHTML" Enabled="True" OneOutput="True" Type="RegexTF" Group="Transformer" />
      <Children Revert="False" Column="OHTML" Enabled="True" IsDebugFilter="True" Type="NullFT" Group="Filter" />
    </Children>
  </Doc>
</root>